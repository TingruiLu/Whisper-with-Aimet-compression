# Whisper Compression Project

This project compresses the Hugging Face Whisper model using **AIMET** and evaluates its performance in terms of memory usage and Word Error Rate (WER). It also provides visualization of the compression process using Bokeh.

---

## Features

- **Model Compression**:
  - The script `whisper_compression.py` compresses the Whisper model, reducing its memory usage to approximately 54% of the original size.
  - The compressed model maintains a WER of around **0.1**.
  - Outputs generated by the script:
    - `greedy_selection_comp_ratios_list.pkl`
    - `greedy_selection_eval_scores_dict.pkl`
  - These files are saved in the `data` folder, and the compressed model is saved as `model.pt` in the root directory.

- **Model Evaluation**:
  - The script `load_compressed_whisper.py` evaluates the compressed model using the Hugging Face `eduativecs2023/dummy_en_asr` audio dataset.
  - Outputs include the generated transcripts and the WER of the compressed model.

- **Visualization**:
  - `bokeh_visualize.py` visualizes the compression results using the `.pkl` files generated during compression.
  - Bokeh provides an interactive HTTP link for visualization.

---

## Requirements

- **Python**: Version 3.10
- **PyTorch**: `torch==2.2.2` (ensure compatibility with your CUDA version)
- **AIMET**: Install following the [AIMET Documentation](https://quic.github.io/aimet-pages/AimetDocs/install/index.html).
- All dependencies are listed in `requirements.txt`.

---

## Setup Instructions

### 1. Create a Virtual Environment
python3.10 -m venv venv
source venv/bin/activate  # Linux/macOS
.\venv\Scripts\activate   # Windows

### 2. Install Dependencies
pip install -r requirements.txt

### 3. Check Torch Version & Compatible CUDA Version
you should have installed torch 2.2.2+cu121 after step 2. Double check the torch version and make sure to install the correct CUDA support.  
More information can be find on https://pytorch.org/get-started/locally/.  
For CUDA: https://developer.nvidia.com/cuda-downloads

### 4. For more AIMET info, please check the documentation
https://quic.github.io/aimet-pages/AimetDocs/install/index.html/

## How to run

### Compress the Whisper Model
python3 whisper_compression.py
- **Outputs:**  
  - Compressed model: model.pt  
  - Compression details
- Due to some updates in AIMET and Bokeh, after the program terminates it will throw out some errors. However this will not affect the result. Scroll up in the terminal to see the compression results.
-Visualization will be done manually later

### Evaluate the Compressed Model
python3 load_compressed_whisper.py
- **Outputs:**
  - Transcripts for the `educativecs2023/dummy_en_asr`
  - WER of the compressed model

### Visualize
bokeh serve --show bokeh_visualize.py
- return a http link, copy and paste to your browser to see the results.

## Notes
all commands are expected to be used in root directory

